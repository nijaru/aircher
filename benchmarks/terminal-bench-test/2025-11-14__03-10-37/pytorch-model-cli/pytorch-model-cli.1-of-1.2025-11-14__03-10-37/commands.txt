['asciinema rec --stdin /logs/agent.cast', 'Enter']
['clear', 'Enter']
['cd /app', 'Enter']
['python3 -m pip install --quiet numpy pillow 2>/dev/null || true', 'Enter']
["cat > /app/mnist_inference.py << 'EOF'\nimport sys\nimport json\nimport numpy as np\nfrom PIL import Image\n\ndef sigmoid(x):\n    return 1 / (1 + np.exp(-np.clip(x, -500, 500)))\n\ndef softmax(x):\n    exp_x = np.exp(x - np.max(x))\n    return exp_x / exp_x.sum()\n\ndef load_weights(weights_file):\n    with open(weights_file, 'r') as f:\n        return json.load(f)\n\ndef preprocess_image(image_file):\n    img = Image.open(image_file).convert('L')\n    img = img.resize((28, 28))\n    img_array = np.array(img).astype(np.float32) / 255.0\n    return img_array.flatten()\n\ndef predict(weights, image_vector):\n    w1 = np.array(weights['w1'])\n    b1 = np.array(weights['b1'])\n    w2 = np.array(weights['w2'])\n    b2 = np.array(weights['b2'])\n    \n    h1 = sigmoid(np.dot(image_vector, w1) + b1)\n    output = np.dot(h1, w2) + b2\n    probs = softmax(output)\n    \n    return np.argmax(probs)\n\nif __name__ == '__main__':\n    if len(sys.argv) != 3:\n        sys.exit(1)\n    \n    weights_file = sys.argv[1]\n    image_file = sys.argv[2]\n    \n    weights = load_weights(weights_file)\n    image_vector = preprocess_image(image_file)\n    prediction = predict(weights, image_vector)\n    \n    print(prediction)\nEOF", 'Enter']
['asciinema rec --stdin /logs/tests.cast', 'Enter']
['clear', 'Enter']
['bash ', '/tests/run-tests.sh', 'Enter']
['C-d']
['C-d']
